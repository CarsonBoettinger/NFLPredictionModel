2025-07-23 11:46:08,827 - INFO - Starting NFL Data Pipeline
2025-07-23 11:46:08,827 - INFO - Step 1: Fetching NFL player statistics...
2025-07-23 11:46:08,827 - INFO - Fetching data from 1999 to 2025
2025-07-23 11:46:08,827 - INFO - Fetching NFL player stats for years: 1999-2025
2025-07-23 11:46:08,827 - INFO - Fetching comprehensive seasonal statistics...
2025-07-23 11:46:18,591 - ERROR - Error fetching player stats: HTTP Error 404: Not Found
2025-07-23 11:46:18,592 - ERROR - Pipeline failed: HTTP Error 404: Not Found
2025-07-23 11:47:15,145 - INFO - Starting NFL Data Pipeline
2025-07-23 11:47:15,145 - INFO - Step 1: Fetching NFL player statistics...
2025-07-23 11:47:15,145 - INFO - Fetching data from 1999 to 2025 (most recent available season)
2025-07-23 11:47:15,145 - INFO - Fetching NFL player stats for years: 1999-2025
2025-07-23 11:47:15,145 - INFO - Fetching comprehensive seasonal statistics...
2025-07-23 11:47:24,177 - WARNING - Most recent year (2025) not available, trying without it...
2025-07-23 11:47:31,265 - INFO - Fetched 15102 total seasonal records
2025-07-23 11:47:31,265 - INFO - Available columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards', 'sack_fumbles', 'sack_fumbles_lost', 'passing_air_yards', 'passing_yards_after_catch', 'passing_first_downs', 'passing_epa', 'passing_2pt_conversions', 'pacr', 'dakota', 'carries', 'rushing_yards', 'rushing_tds', 'rushing_fumbles', 'rushing_fumbles_lost', 'rushing_first_downs', 'rushing_epa', 'rushing_2pt_conversions', 'receptions', 'targets', 'receiving_yards', 'receiving_tds', 'receiving_fumbles', 'receiving_fumbles_lost', 'receiving_air_yards', 'receiving_yards_after_catch', 'receiving_first_downs', 'receiving_epa', 'receiving_2pt_conversions', 'racr', 'target_share', 'air_yards_share', 'wopr_x', 'special_teams_tds', 'fantasy_points', 'fantasy_points_ppr', 'games', 'tgt_sh', 'ay_sh', 'yac_sh', 'wopr_y', 'ry_sh', 'rtd_sh', 'rfd_sh', 'rtdfd_sh', 'dom', 'w8dom', 'yptmpa', 'ppr_sh']
2025-07-23 11:47:31,270 - INFO - Filtered 2646 passing records
2025-07-23 11:47:31,271 - INFO - Filtered 8475 rushing records
2025-07-23 11:47:31,273 - INFO - Filtered 11733 receiving records
2025-07-23 11:47:31,273 - INFO - Fetching roster data for player metadata...
2025-07-23 11:47:31,273 - WARNING - No roster import function found
2025-07-23 11:47:31,273 - INFO - Fetching recent weekly data...
2025-07-23 11:47:31,274 - INFO - Fetching weekly NFL player stats for years: 2023-2025
2025-07-23 11:47:31,274 - INFO - Fetching weekly statistics...
2025-07-23 11:47:31,274 - WARNING - Could not fetch weekly data: import_weekly_data() got an unexpected keyword argument 's_type'
2025-07-23 11:47:31,274 - INFO - Fetching current season data...
2025-07-23 11:47:31,274 - INFO - Fetching current season (2025) data...
2025-07-23 11:47:31,408 - WARNING - Could not fetch current season data: HTTP Error 404: Not Found
2025-07-23 11:47:31,409 - INFO - Fetching current roster data...
2025-07-23 11:47:31,409 - INFO - Attempting to fetch roster data for 2025...
2025-07-23 11:47:31,978 - INFO - Successfully fetched roster data for 2025: 36 records
2025-07-23 11:47:31,978 - INFO - Step 2: Saving raw data...
2025-07-23 11:47:31,978 - INFO - Saving raw data in parquet format...
2025-07-23 11:47:32,011 - INFO - Saved passing data to nfl_data/raw/passing_stats.parquet
2025-07-23 11:47:32,032 - INFO - Saved rushing data to nfl_data/raw/rushing_stats.parquet
2025-07-23 11:47:32,056 - INFO - Saved receiving data to nfl_data/raw/receiving_stats.parquet
2025-07-23 11:47:32,058 - INFO - Saved current_roster data to nfl_data/raw/current_roster_stats.parquet
2025-07-23 11:47:32,058 - INFO - Step 3: Cleaning and preprocessing data...
2025-07-23 11:47:32,058 - INFO - Starting data cleaning and preprocessing...
2025-07-23 11:47:32,064 - INFO - Combined dataset shape: (22890, 75)
2025-07-23 11:47:32,064 - INFO - Cleaning data...
2025-07-23 11:47:32,180 - INFO - Cleaning removed 36 rows
2025-07-23 11:47:32,182 - INFO - Step 4: Engineering features...
2025-07-23 11:47:32,182 - INFO - Engineering features...
2025-07-23 11:47:32,237 - INFO - Feature engineering completed. New shape: (22854, 129)
2025-07-23 11:47:32,238 - INFO - Step 5: Saving interpretable data...
2025-07-23 11:47:32,320 - INFO - Saved interpretable data to nfl_data/processed/interpretable_nfl_data.parquet
2025-07-23 11:47:32,390 - INFO - Saved interpretable sample CSV to nfl_data/processed/interpretable_nfl_data_sample.csv
2025-07-23 11:47:32,390 - INFO - Step 6: Normalizing and encoding features...
2025-07-23 11:47:32,391 - INFO - Normalizing and encoding features...
2025-07-23 11:47:32,764 - INFO - Normalized 110 numerical features
2025-07-23 11:47:32,780 - INFO - Created 3 categorical features
2025-07-23 11:47:32,780 - INFO - Final processed dataset shape: (22854, 131)
2025-07-23 11:47:32,780 - INFO - Step 7: Saving processed data...
2025-07-23 11:47:32,855 - INFO - Saved processed data to nfl_data/processed/processed_nfl_data.parquet
2025-07-23 11:47:32,922 - INFO - Saved sample CSV to nfl_data/processed/processed_nfl_data_sample.csv
2025-07-23 11:47:32,950 - INFO - Pipeline completed successfully!
2025-07-23 11:47:32,951 - INFO - Data Summary: {'total_records': 22854, 'total_features': 129, 'years_covered': [1999.0, 2000.0, 2001.0, 2002.0, 2003.0, 2004.0, 2005.0, 2006.0, 2007.0, 2008.0, 2009.0, 2010.0, 2011.0, 2012.0, 2013.0, 2014.0, 2015.0, 2016.0, 2017.0, 2018.0, 2019.0, 2020.0, 2021.0, 2022.0, 2023.0, 2024.0], 'positions': [], 'missing_data_percentage': 0.0}
